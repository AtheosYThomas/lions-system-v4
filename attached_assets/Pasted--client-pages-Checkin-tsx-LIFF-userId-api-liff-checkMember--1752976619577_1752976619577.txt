ç¬¬ä¸€æ­¥ã€‘å»ºç«‹ /client/pages/Checkin.tsx ç•«é¢
ğŸ”§ åŠŸèƒ½éœ€æ±‚ï¼š
åˆå§‹åŒ– LIFF ä¸¦æ“·å– userId

å‘¼å« /api/liff/checkMember â†’ ç¢ºèªæ˜¯å¦ç‚ºæœƒå“¡

è‹¥ç‚ºæœƒå“¡ï¼š é¡¯ç¤ºæ­¡è¿è¨Šæ¯èˆ‡å¯å ±åæ´»å‹•æ¸…å–®

è‹¥ä¸æ˜¯æœƒå“¡ï¼š è‡ªå‹•å°å‘ /register é é¢å¡«å¯«è¡¨å–®

ğŸ“ ä½ æ‡‰åœ¨ /client/pages/Checkin.tsx å»ºç«‹ä»¥ä¸‹ç¨‹å¼ç¢¼ï¼š
tsx
è¤‡è£½
ç·¨è¼¯
import { useEffect, useState } from "react";
import axios from "axios";
import { useNavigate } from "wouter";

export default function Checkin() {
  const [lineUserId, setLineUserId] = useState<string | null>(null);
  const [member, setMember] = useState<any>(null);
  const [loading, setLoading] = useState(true);
  const navigate = useNavigate();

  useEffect(() => {
    if (window.liff) {
      window.liff.init({ liffId: import.meta.env.VITE_LIFF_ID })
        .then(() => {
          if (!window.liff.isLoggedIn()) {
            window.liff.login();
          } else {
            const userId = window.liff.getContext()?.userId;
            setLineUserId(userId);
          }
        })
        .catch(console.error);
    }
  }, []);

  useEffect(() => {
    if (lineUserId) {
      axios.post("/api/liff/checkMember", { lineUserId })
        .then(res => {
          if (res.data?.member) {
            setMember(res.data.member);
          } else {
            navigate("/register");
          }
        })
        .catch(err => {
          console.error("Check member failed:", err);
          navigate("/register");
        })
        .finally(() => setLoading(false));
    }
  }, [lineUserId]);

  if (loading) return <div className="p-4">è¼‰å…¥ä¸­...</div>;

  return (
    <div className="p-4">
      <h1 className="text-xl font-bold mb-2">æ‚¨å¥½ï¼Œ{member.name}ï¼</h1>
      <p className="mb-4">ä»¥ä¸‹æ˜¯æ‚¨å¯åƒåŠ çš„æ´»å‹•ï¼š</p>
      <ul className="list-disc pl-5">
        {(member?.events || []).map((event: any) => (
          <li key={event.id}>
            {event.name}ï¼ˆ{event.date}ï¼‰<br />
            {event.status === "checked_in" ? "âœ… å·²ç°½åˆ°" : "â³ å°šæœªç°½åˆ°"}
          </li>
        ))}
      </ul>
    </div>
  );
}
ğŸ“¡ å¾Œç«¯å°æ‡‰ APIï¼ˆå·²å»ºè­°éï¼‰ï¼š
/api/liff/checkMemberï¼šæ¥æ”¶ lineUserIdï¼Œå›å‚³æœƒå“¡è³‡è¨Šèˆ‡æ´»å‹•æ¸…å–®

ts
è¤‡è£½
ç·¨è¼¯
// Body: { lineUserId: string }
// Response: { member: { name: string, events: Event[] } | null }
